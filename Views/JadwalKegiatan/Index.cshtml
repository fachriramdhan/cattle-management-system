@model IEnumerable<SimSapi.Models.JadwalKegiatan>
@{
    ViewData["Title"] = "Jadwal Kegiatan";
}

<div class="space-y-6">

<!-- ================= HEADER & FILTER ================= -->
<div class="relative bg-slate-900 border border-slate-800 rounded-2xl p-6 shadow space-y-5 overflow-hidden">

    <!-- ICON BACKGROUND -->
    <i class="fas fa-calendar-check absolute left-6 top-1/2 -translate-y-1/2
              text-[200px] text-emerald-500/10
              pointer-events-none select-none"></i>

    <div class="relative flex flex-col md:flex-row md:items-center md:justify-between gap-4">

        <div class="pl-2 md:pl-20">
            <h2 class="text-xl font-bold text-white">
                Jadwal Kegiatan Peternak
            </h2>
            <p class="text-slate-400 text-sm mt-1">
                Kelola vaksinasi, pelatihan, dan kegiatan lainnya
            </p>
        </div>

        @if (User.IsInRole("Admin"))
        {
            <a asp-action="Create"
               class="flex items-center gap-2 bg-sky-500/10 text-sky-400
                      px-5 py-2 rounded-xl hover:bg-sky-500/20 transition">
                <i class="fas fa-plus"></i>
                Tambah Jadwal
            </a>
        }
    </div>

    <!-- FILTER -->
    <form method="get"
          class="relative grid grid-cols-1 md:grid-cols-3 gap-3">

        <select name="status"
                class="bg-slate-950 border border-slate-800 text-slate-200
                       rounded-xl px-4 py-2">
            <option value="">Semua Status</option>
            <option value="Terjadwal" selected="@(ViewData["Status"]?.ToString() == "Terjadwal")">Terjadwal</option>
            <option value="Berlangsung" selected="@(ViewData["Status"]?.ToString() == "Berlangsung")">Berlangsung</option>
            <option value="Selesai" selected="@(ViewData["Status"]?.ToString() == "Selesai")">Selesai</option>
            <option value="Dibatalkan" selected="@(ViewData["Status"]?.ToString() == "Dibatalkan")">Dibatalkan</option>
        </select>

        <select name="jenis"
                class="bg-slate-950 border border-slate-800 text-slate-200
                       rounded-xl px-4 py-2">
            <option value="">Semua Jenis</option>
            <option value="Umum" selected="@(ViewData["Jenis"]?.ToString() == "Umum")">Umum</option>
            <option value="Vaksinasi" selected="@(ViewData["Jenis"]?.ToString() == "Vaksinasi")">Vaksinasi</option>
            <option value="Pelatihan" selected="@(ViewData["Jenis"]?.ToString() == "Pelatihan")">Pelatihan</option>
            <option value="Rapat" selected="@(ViewData["Jenis"]?.ToString() == "Rapat")">Rapat</option>
        </select>

        <button type="submit"
                class="bg-slate-800 hover:bg-slate-700 text-white
                       rounded-xl flex items-center justify-center gap-2 transition">
            <i class="fas fa-filter"></i>
            Filter
        </button>
    </form>
</div>

<!-- ================= CARD LIST ================= -->
@if (Model.Any())
{
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

        @foreach (var item in Model)
        {
            var statusBadge = item.Status switch
            {
                "Terjadwal" => "bg-sky-500/10 text-sky-400",
                "Berlangsung" => "bg-emerald-500/10 text-emerald-400",
                "Selesai" => "bg-slate-500/10 text-slate-400",
                "Dibatalkan" => "bg-red-500/10 text-red-400",
                _ => "bg-slate-500/10 text-slate-400"
            };

            var jenisIcon = item.JenisKegiatan switch
            {
                "Vaksinasi" => "fa-syringe",
                "Pelatihan" => "fa-graduation-cap",
                "Rapat" => "fa-users",
                _ => "fa-calendar"
            };

            <div class="bg-slate-900 border border-slate-800 rounded-2xl shadow
                        hover:bg-slate-950 transition overflow-hidden">

                <!-- CARD HEADER -->
                <div class="relative p-4 border-b border-slate-800">

                    <i class="fas fa-cow absolute -right-6 -bottom-6
                              text-[120px] text-emerald-500/10"></i>

                    <div class="relative flex justify-between items-start">
                        <div class="flex items-center gap-2 text-white">
                            <i class="fas @jenisIcon text-lg text-sky-400"></i>
                            <span class="text-sm font-medium">
                                @item.JenisKegiatan
                            </span>
                        </div>

                        <span class="px-2 py-1 text-xs rounded-lg @statusBadge">
                            @item.Status
                        </span>
                    </div>

                    <h4 class="mt-3 text-white font-semibold text-lg">
                        @item.NamaKegiatan
                    </h4>
                </div>

                <!-- CARD BODY -->
                <div class="p-4 space-y-3 text-sm text-slate-300">

                    <p class="line-clamp-2">
                        @item.Deskripsi
                    </p>

                    <div class="flex items-center gap-2">
                        <i class="fas fa-calendar text-slate-500"></i>
                        @item.TanggalMulai.ToString("dd MMM yyyy")
                    </div>

                    <div class="flex items-center gap-2">
                        <i class="fas fa-clock text-slate-500"></i>
                        @item.TanggalMulai.ToString("HH:mm") - @item.TanggalSelesai.ToString("HH:mm")
                    </div>

                    @if (!string.IsNullOrEmpty(item.Lokasi))
                    {
                        <div class="flex items-center gap-2">
                            <i class="fas fa-map-marker-alt text-slate-500"></i>
                            @item.Lokasi
                        </div>
                    }

                    <div class="flex items-center gap-2">
                        <i class="fas fa-users text-slate-500"></i>
                        @item.Peserta.Count peserta
                    </div>

                    <a asp-action="Details" asp-route-id="@item.Id"
                       class="mt-4 w-full bg-sky-500/10 hover:bg-sky-500/20
                              text-sky-400 py-2 rounded-xl
                              flex items-center justify-center gap-2 transition font-medium">
                        <i class="fas fa-eye"></i>
                        Detail
                    </a>
                </div>
            </div>
        }
    </div>
}
else
{
    <div class="bg-slate-900 border border-slate-800 rounded-2xl
                p-16 text-center text-slate-500">
        <i class="fas fa-calendar-times text-5xl mb-4 block"></i>
        Tidak ada jadwal kegiatan
    </div>
}
</div>
